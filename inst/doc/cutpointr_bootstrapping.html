<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Christian Thiele, Lorenz A. Kapsner" />

<meta name="date" content="2024-12-10" />

<title>cutpointr: Bootstrapping</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">cutpointr: Bootstrapping</h1>
<h4 class="author">Christian Thiele, Lorenz A. Kapsner</h4>
<h4 class="date">2024-12-10</h4>



<p>Bootstrapping is implemented in <strong>cutpointr</strong> with two
goals:</p>
<ol style="list-style-type: decimal">
<li>Determine optimal cutpoints with bootstrapping (as an alternative to
determining them without bootstrapping)</li>
<li>Validate (any) cutpoint optimization with bootstrapping</li>
</ol>
<p>This vignette will briefly go through some examples for both
approaches.</p>
<div id="determine-optimal-cutpoints" class="section level1">
<h1>Determine optimal cutpoints</h1>
<div id="without-bootstrapping-maximize_metric" class="section level2">
<h2>Without bootstrapping: <code>maximize_metric</code></h2>
<p>As a first basic example, the cutpoint optimization will be
demonstrated without any bootstrapping by maximizing the Youden-Index.
Using the method <code>maximize_metric</code>, this is performed on the
full data set:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(cutpointr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">data</span>(suicide)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>opt_cut <span class="ot">&lt;-</span> <span class="fu">cutpointr</span>(</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="at">data =</span> suicide,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    <span class="at">x =</span> dsi,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    <span class="at">class =</span> suicide,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="at">method =</span> maximize_metric,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    <span class="at">metric =</span> youden,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="at">pos_class =</span> <span class="st">&quot;yes&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&gt;=&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a><span class="fu">summary</span>(opt_cut)</span></code></pre></div>
<pre><code>## Method: maximize_metric 
## Predictor: dsi 
## Outcome: suicide 
## Direction: &gt;= 
## 
##     AUC   n n_pos n_neg
##  0.9238 532    36   496
## 
##  optimal_cutpoint youden    acc sensitivity specificity tp fn fp  tn
##                 2 0.7518 0.8647      0.8889      0.8629 32  4 68 428
## 
## Predictor summary: 
##     Data Min.   5% 1st Qu. Median      Mean 3rd Qu.  95% Max.       SD NAs
##  Overall    0 0.00       0      0 0.9210526       1 5.00   11 1.852714   0
##       no    0 0.00       0      0 0.6330645       0 4.00   10 1.412225   0
##      yes    0 0.75       4      5 4.8888889       6 9.25   11 2.549821   0</code></pre>
<p>The fields in the resulting R object <code>opt_cut</code> are to be
interpreted as follows:</p>
<ul>
<li><code>$optimal_cutpoint</code>: The optimal cutpoint determined by
maximizing the Youden-Index on the full <code>suicide</code>
dataset.</li>
<li><code>$sensitivity</code>: The sensitivity when applying the
cutpoint to the full dataset.</li>
<li><code>$specificity</code>: The specificity when applying the
cutpoint to the full dataset.</li>
<li><code>$youden</code>: The maximal Youden-Index (= sensitivity +
specificity - 1), determined by the optimization.</li>
</ul>
</div>
<div id="bootstrap-cutpoints-maximize_boot_metric" class="section level2">
<h2>Bootstrap cutpoints: <code>maximize_boot_metric</code></h2>
<p>The determination of the optimal cutpoint can also be performed using
bootstrapping. Therefore, the methods
<code>maximize_boot_metric</code>/<code>minimize_boot_metric</code> need
to be chosen. These functions provide further arguments that can be used
to configure the bootstrapping. These arguments can be viewed with
<code>help(&quot;maximize_boot_metric&quot;, &quot;cutpointr&quot;)</code>. The most
important arguments are:</p>
<ul>
<li><code>boot_cut</code>: The number of bootstrapping repetitions.</li>
<li><code>boot_stratify</code>: If the bootstrap samples are drawn in
both classes separately before combining them, keep the number of
positives/negatives constant in every sample.</li>
<li><code>summary_func</code>: The summary function to aggregate the
optimal cutpoints from the bootstrapping to arrive at one final optimal
cutpoint.</li>
</ul>
<p>The cutpoint is optimized in n=<code>boot_cut</code> bootstrap
samples by maximizing/ minimizing the respective metric (e.g., the
Youden-index in this example) in each of these bootstrap samples.
Finally, the summary function is applied to aggregate the optimal
cutpoints from the n=<code>boot_cut</code> bootstrap samples into one
final ‘optimal’ cutpoint.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>opt_cut <span class="ot">&lt;-</span> <span class="fu">cutpointr</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    <span class="at">data =</span> suicide,</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>    <span class="at">x =</span> dsi,</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="at">class =</span> suicide,</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    <span class="at">method =</span> maximize_boot_metric,</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="at">boot_cut =</span> <span class="dv">200</span>,</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="at">summary_func =</span> mean,</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="at">metric =</span> youden,</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="at">pos_class =</span> <span class="st">&quot;yes&quot;</span>,</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&gt;=&quot;</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>)</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a><span class="fu">summary</span>(opt_cut)</span></code></pre></div>
<pre><code>## Method: maximize_boot_metric 
## Predictor: dsi 
## Outcome: suicide 
## Direction: &gt;= 
## 
##     AUC   n n_pos n_neg
##  0.9238 532    36   496
## 
##  optimal_cutpoint youden    acc sensitivity specificity tp fn fp  tn
##             2.055 0.6927 0.8816      0.8056      0.8871 29  7 56 440
## 
## Predictor summary: 
##     Data Min.   5% 1st Qu. Median      Mean 3rd Qu.  95% Max.       SD NAs
##  Overall    0 0.00       0      0 0.9210526       1 5.00   11 1.852714   0
##       no    0 0.00       0      0 0.6330645       0 4.00   10 1.412225   0
##      yes    0 0.75       4      5 4.8888889       6 9.25   11 2.549821   0</code></pre>
<p>The fields in the resulting R object <code>opt_cut</code> are to be
interpreted as follows:</p>
<ul>
<li><code>$optimal_cutpoint</code>: The optimal cutpoint, which is the
aggregated value (as defined with <code>summary_func</code>) over all
n=<code>boot_cut</code> bootstrap samples. Please note that no
uncertainty measure (standard deviation, 95%-CI, etc.) is available here
(a bootstrap distribution of these cutpoints can be generated using
outer bootstrapping with <code>boot_runs &gt; 0</code> and
<code>maximize_metric</code>, as explained below).</li>
<li><code>$sensitivity</code>: The sensitivity when applying the optimal
cutpoint to the full dataset.</li>
<li><code>$specificity</code>: The specificity when applying the optimal
cutpoint to the full dataset.</li>
<li><code>$youden</code>: The Youden-Index when applying the optimal
cutpoint to the full dataset.</li>
</ul>
</div>
</div>
<div id="validate-cutpoint-optimization-with-bootstrapping" class="section level1">
<h1>Validate cutpoint optimization with bootstrapping</h1>
<p>Any chosen methods to find the optimal cutpoints can be subsequently
validated with bootstrapping. This can easily be activated by setting
the argument <code>boot_runs</code> &gt; 0. Please be aware that the
first steps to calculate the optimal cutpoints with the specified method
(as described above) will be performed in the very same manner as above,
resulting in the same outputs as above (depending on the seed when
bootstrapping cutpoints).</p>
<p>However, the method to calculate the optimal cutpoints will then
additionally be performed on n=<code>boot_runs</code> bootstrap samples.
For each of these bootstrap samples, several metrics and performance
measures are available from the resulting <code>$boot</code> object,
both for the <em>in-bag</em> (suffix: ‘_b’) and the <em>out-of-bag</em>
(suffix: ‘_oob’) bootstrap samples. Please note that the optimal
cutpoint is determined on the in-bag samples only and then just applied
to the out-of-bag samples for validation purposes, so its value is
available only once in the <code>$boot</code> object without a
suffix.</p>
<div id="maximize_metric" class="section level2">
<h2><code>maximize_metric</code></h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>opt_cut <span class="ot">&lt;-</span> <span class="fu">cutpointr</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>    <span class="at">data =</span> suicide,</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="at">x =</span> dsi,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>    <span class="at">class =</span> suicide,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    <span class="at">method =</span> maximize_metric,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="at">metric =</span> youden,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>    <span class="at">pos_class =</span> <span class="st">&quot;yes&quot;</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&gt;=&quot;</span>,</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    <span class="at">boot_runs =</span> <span class="dv">100</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running bootstrap...</code></pre>
<p>The interpretation of fields in the resulting R object
<code>opt_cut</code> is the same as above. The results from the
bootstrapping are available from <code>$boot</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">summary</span>(opt_cut)</span></code></pre></div>
<pre><code>## Method: maximize_metric 
## Predictor: dsi 
## Outcome: suicide 
## Direction: &gt;= 
## Nr. of bootstraps: 100 
## 
##     AUC   n n_pos n_neg
##  0.9238 532    36   496
## 
##  optimal_cutpoint youden    acc sensitivity specificity tp fn fp  tn
##                 2 0.7518 0.8647      0.8889      0.8629 32  4 68 428
## 
## Predictor summary: 
##     Data Min.   5% 1st Qu. Median      Mean 3rd Qu.  95% Max.       SD NAs
##  Overall    0 0.00       0      0 0.9210526       1 5.00   11 1.852714   0
##       no    0 0.00       0      0 0.6330645       0 4.00   10 1.412225   0
##      yes    0 0.75       4      5 4.8888889       6 9.25   11 2.549821   0
## 
## Bootstrap summary: 
##          Variable Min.   5% 1st Qu. Median Mean 3rd Qu.  95% Max.   SD NAs
##  optimal_cutpoint 1.00 1.00    2.00   2.00 2.08    2.00 4.00 4.00 0.69   0
##             AUC_b 0.85 0.89    0.90   0.92 0.92    0.94 0.96 0.97 0.02   0
##           AUC_oob 0.82 0.86    0.91   0.93 0.92    0.95 0.97 0.98 0.04   0
##          youden_b 0.60 0.67    0.72   0.75 0.75    0.79 0.85 0.89 0.06   0
##        youden_oob 0.49 0.58    0.67   0.73 0.72    0.78 0.84 0.87 0.08   0
##             acc_b 0.74 0.77    0.86   0.87 0.86    0.88 0.91 0.92 0.04   0
##           acc_oob 0.74 0.77    0.84   0.86 0.86    0.88 0.90 0.92 0.04   0
##     sensitivity_b 0.76 0.82    0.86   0.89 0.90    0.93 0.97 1.00 0.05   0
##   sensitivity_oob 0.60 0.69    0.81   0.87 0.86    0.92 1.00 1.00 0.09   0
##     specificity_b 0.72 0.76    0.85   0.87 0.86    0.88 0.91 0.92 0.04   0
##   specificity_oob 0.73 0.76    0.84   0.86 0.86    0.88 0.91 0.93 0.04   0
##    cohens_kappa_b 0.19 0.25    0.38   0.43 0.41    0.46 0.52 0.56 0.07   0
##  cohens_kappa_oob 0.15 0.25    0.34   0.39 0.39    0.44 0.49 0.56 0.08   0</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>opt_cut<span class="sc">$</span>boot[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 23
##   optimal_cutpoint AUC_b AUC_oob youden_b youden_oob acc_b acc_oob sensitivity_b
##              &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;
## 1                2 0.891   0.95     0.732      0.698 0.852   0.863         0.882
## 2                1 0.912   0.969    0.705      0.753 0.774   0.769         0.943
## 3                2 0.902   0.934    0.718      0.780 0.842   0.918         0.879
## 4                2 0.892   0.961    0.662      0.808 0.842   0.880         0.818
## 5                2 0.893   0.966    0.701      0.818 0.850   0.909         0.851
## 6                2 0.941   0.909    0.788      0.755 0.891   0.843         0.897
## # ℹ 15 more variables: sensitivity_oob &lt;dbl&gt;, specificity_b &lt;dbl&gt;,
## #   specificity_oob &lt;dbl&gt;, cohens_kappa_b &lt;dbl&gt;, cohens_kappa_oob &lt;dbl&gt;,
## #   TP_b &lt;dbl&gt;, FP_b &lt;dbl&gt;, TN_b &lt;int&gt;, FN_b &lt;int&gt;, TP_oob &lt;dbl&gt;, FP_oob &lt;dbl&gt;,
## #   TN_oob &lt;int&gt;, FN_oob &lt;int&gt;, roc_curve_b &lt;list&gt;, roc_curve_oob &lt;list&gt;</code></pre>
</div>
<div id="maximize_boot_metric" class="section level2">
<h2><code>maximize_boot_metric</code></h2>
<p>When bootstrapping cutpoints and also using the validation with
bootstrapping, the optimal cutpoint will again first be determined as
above in n=<code>boot_cut</code> bootstrap samples by maximizing/
minimizing the respective metric in each of these bootstrap samples and
then by applying the summary function to aggregate the optimal cutpoints
from the n=<code>boot_cut</code> bootstrap samples into one final
‘optimal’ cutpoint. Hence, using the same seeds here results in the same
outputs as above, where no outer bootstrapping is applied.</p>
<p>In the validation routine, the chosen cutpoint optimization is then
repeated in each of the n=<code>boot_runs</code> (outer) bootstrap
samples: the optimal cutpoint is determined in each bootstrap sample by
optimizing the <code>metric</code> on n=<code>boot_cut</code> (inner)
bootstrap samples and applying the <code>summary_func</code> to
aggregate them into one value.</p>
<p>Since the (inner) bootstrapping of optimal cutpoints is performed in
each of the (outer) validation bootstrap samples, this can be
computational very expensive and take some time to finish. Therefore,
parallelization is implemented in <code>cutpointr</code> by just setting
its argument <code>allowParallel = TRUE</code> and initializing a
parallel environment.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">library</span>(doParallel)</span></code></pre></div>
<pre><code>## Warning: package &#39;doParallel&#39; was built under R version 4.4.2</code></pre>
<pre><code>## Loading required package: foreach</code></pre>
<pre><code>## Loading required package: iterators</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">library</span>(doRNG)</span></code></pre></div>
<pre><code>## Warning: package &#39;doRNG&#39; was built under R version 4.4.2</code></pre>
<pre><code>## Loading required package: rngtools</code></pre>
<pre><code>## Warning: package &#39;rngtools&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">makeCluster</span>(<span class="dv">2</span>) <span class="co"># 2 cores</span></span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="fu">registerDoParallel</span>(cl)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="fu">registerDoRNG</span>(<span class="dv">12</span>)</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>opt_cut <span class="ot">&lt;-</span> <span class="fu">cutpointr</span>(</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>    <span class="at">data =</span> suicide,</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>    <span class="at">x =</span> dsi,</span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>    <span class="at">class =</span> suicide,</span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>    <span class="at">method =</span> maximize_boot_metric,</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>    <span class="at">boot_cut =</span> <span class="dv">200</span>,</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>    <span class="at">summary_func =</span> mean,</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>    <span class="at">metric =</span> youden,</span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>    <span class="at">pos_class =</span> <span class="st">&quot;yes&quot;</span>,</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>    <span class="at">direction =</span> <span class="st">&quot;&gt;=&quot;</span>,</span>
<span id="cb20-15"><a href="#cb20-15" tabindex="-1"></a>    <span class="at">boot_runs =</span> <span class="dv">100</span>,</span>
<span id="cb20-16"><a href="#cb20-16" tabindex="-1"></a>    <span class="at">allowParallel =</span> <span class="cn">TRUE</span></span>
<span id="cb20-17"><a href="#cb20-17" tabindex="-1"></a>)</span></code></pre></div>
<pre><code>## Running bootstrap...</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="fu">stopCluster</span>(cl)</span></code></pre></div>
<p>Again, the interpretation of fields in the resulting R object
<code>opt_cut</code> is the same as above. The results from the
bootstrapping are available from <code>$boot</code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">summary</span>(opt_cut)</span></code></pre></div>
<pre><code>## Method: maximize_boot_metric 
## Predictor: dsi 
## Outcome: suicide 
## Direction: &gt;= 
## Nr. of bootstraps: 100 
## 
##     AUC   n n_pos n_neg
##  0.9238 532    36   496
## 
##  optimal_cutpoint youden    acc sensitivity specificity tp fn fp  tn
##             2.055 0.6927 0.8816      0.8056      0.8871 29  7 56 440
## 
## Predictor summary: 
##     Data Min.   5% 1st Qu. Median      Mean 3rd Qu.  95% Max.       SD NAs
##  Overall    0 0.00       0      0 0.9210526       1 5.00   11 1.852714   0
##       no    0 0.00       0      0 0.6330645       0 4.00   10 1.412225   0
##      yes    0 0.75       4      5 4.8888889       6 9.25   11 2.549821   0
## 
## Bootstrap summary: 
##          Variable Min.   5% 1st Qu. Median Mean 3rd Qu.  95% Max.   SD NAs
##  optimal_cutpoint 1.07 1.60    1.93   2.08 2.16    2.28 2.97 3.60 0.45   0
##             AUC_b 0.86 0.89    0.91   0.93 0.93    0.94 0.96 0.96 0.02   0
##           AUC_oob 0.84 0.88    0.90   0.92 0.92    0.95 0.97 0.98 0.03   0
##          youden_b 0.60 0.63    0.68   0.72 0.72    0.76 0.79 0.84 0.05   0
##        youden_oob 0.48 0.57    0.64   0.69 0.71    0.78 0.84 0.88 0.09   0
##             acc_b 0.83 0.85    0.87   0.88 0.88    0.89 0.91 0.93 0.02   0
##           acc_oob 0.83 0.84    0.86   0.88 0.88    0.89 0.91 0.92 0.02   0
##     sensitivity_b 0.71 0.75    0.80   0.83 0.84    0.87 0.91 0.94 0.05   0
##   sensitivity_oob 0.58 0.69    0.75   0.81 0.83    0.91 1.00 1.00 0.10   0
##     specificity_b 0.83 0.85    0.87   0.88 0.88    0.89 0.91 0.94 0.02   0
##   specificity_oob 0.82 0.83    0.87   0.88 0.88    0.90 0.92 0.93 0.03   0
##    cohens_kappa_b 0.32 0.33    0.38   0.42 0.43    0.47 0.54 0.59 0.06   0
##  cohens_kappa_oob 0.22 0.31    0.37   0.41 0.41    0.47 0.53 0.56 0.07   0</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>opt_cut<span class="sc">$</span>boot[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> </span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a>  <span class="fu">head</span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 × 23
##   optimal_cutpoint AUC_b AUC_oob youden_b youden_oob acc_b acc_oob sensitivity_b
##              &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;         &lt;dbl&gt;
## 1             2.34 0.931   0.950    0.729      0.613 0.870   0.892         0.857
## 2             2.58 0.948   0.896    0.725      0.628 0.883   0.867         0.839
## 3             1.70 0.939   0.889    0.784      0.711 0.872   0.846         0.914
## 4             1.95 0.894   0.962    0.680      0.844 0.861   0.851         0.816
## 5             2.03 0.906   0.963    0.692      0.786 0.885   0.872         0.8  
## 6             2.58 0.928   0.881    0.771      0.540 0.900   0.860         0.868
## # ℹ 15 more variables: sensitivity_oob &lt;dbl&gt;, specificity_b &lt;dbl&gt;,
## #   specificity_oob &lt;dbl&gt;, cohens_kappa_b &lt;dbl&gt;, cohens_kappa_oob &lt;dbl&gt;,
## #   TP_b &lt;dbl&gt;, FP_b &lt;dbl&gt;, TN_b &lt;int&gt;, FN_b &lt;int&gt;, TP_oob &lt;dbl&gt;, FP_oob &lt;dbl&gt;,
## #   TN_oob &lt;int&gt;, FN_oob &lt;int&gt;, roc_curve_b &lt;list&gt;, roc_curve_oob &lt;list&gt;</code></pre>
<p>Some visualizations of the bootstrapping results are available with
the <code>plot</code> function:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="fu">plot</span>(opt_cut)</span></code></pre></div>
<p><img role="img" src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The two plots in the lower half can be generated separately with
<code>plot_cut_boot(opt_cut)</code> and
<code>plot_metric_boot(opt_cut)</code>.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
